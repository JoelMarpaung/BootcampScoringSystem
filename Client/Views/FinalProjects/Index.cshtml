
@{
    ViewData["Title"] = "Index";
}

<h2>Final Project</h2>
<p>
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal" onclick="ClearScreen();">
        Create New
    </button>
</p>

<table id="dataGrid" class="table table-striped table-bordered dt-responsive nowrap">
    <thead style="background-color:#df816c">
        <tr>
            <th>
                Id
            </th>
            <th>
                Name Final Project
            </th>
            <th>
                Weigth (%)
            </th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody style="background-color:bisque" class="tbody"></tbody>

</table>

<div class="container">
    <!-- Modal -->
    <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Course Comprehension</h4>
                </div>
                <div class="modal-body">
                    <div class="container">
                        <form>
                            <div class="form-group" hidden="hidden">
                                <label for="Id">Id  </label>
                                <input type="text" class="form-control" id="Id" placeholder="Id" name="Id" />
                            </div>
                            <div class="form-group">
                                <label for="Name">Name Final Project</label>
                                <input type="text" class="form-control" id="Name" placeholder="Name" name="Name">
                            </div>
                            <div class="form-group">
                                <label for="Weight">Weight (%)</label>
                                <input type="text" class="form-control" id="Weight" placeholder="Weight" name="Weight">
                            </div>
                        </form>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="btnAdd" onclick="return Create();">Add</button>
                    <button type="button" class="btn btn-primary" id="btnUpdate" data-dismiss="modal" onclick="return Update();">Update</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    $('#dataGrid').dataTable({
        "columnDefs": [{ "orderable": false, "targets": 3 }],
        "ajax": loadData(),
        "responsive": true
    });

    function loadData() {
        debugger;
        $.ajax({
            url: "/FinalProjects/List",
            type: "GET",
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            success: function (result) {
                var html = '';
                const obj = JSON.parse(result);
                $.each(result, function (index, item) {
                    html += '<tr>';
                    html += '<td>' + item.Id + '</td>';
                    html += '<td>' + item.Name + '</td>';
                    html += '<td>' + item.Weight + '</td>';
                    html += '<td><button type="button" class="btn btn-warning" id="Edit" onclick="return getbyID(' + item.Id + ')">Edit</button> ' +
                        '<button type="button" class="btn btn-danger" id="Delete" onclick="return Delete(' + item.Id + ')" > Delete</button ></td > ';
                    html += '</tr>';
                });
                $('.tbody').html(html);
            },
            error: function (errormessage) {
                Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: 'Something went wrong!'
                })
            }
        });
    }

    //function Create() {
    //    var final = new Object();
    //    final.Name = $('#Name').val();
    //    final.Weight = $('#Weight').val();
    //    $.ajax({
    //        url: "CourseComprehensions/InsertOrUpdate/",
    //        type: "POST",
    //        dataType: "json",
    //        data: final,
    //        success: function (result) {
    //            //debugger;
    //            console.log(result.StatusCode);
    //            $('#myModal').modal('hide');
    //            loadData();
    //            ClearScreen();
    //            if (result.StatusCode == 200) {
    //                Swal.fire(
    //                    'Success',
    //                    'Data has been created',
    //                    'success'
    //                );
    //            } else {
    //                Swal.fire({
    //                    icon: 'error',
    //                    title: 'Oops...',
    //                    text: 'Something went wrong!'
    //                });
    //            }

    //        },
    //        error: function (errormessage) {
    //            Swal.fire({
    //                icon: 'error',
    //                title: 'Oops...',
    //                text: 'Something went wrong!'
    //            })
    //        }

    //    });
    //}

    //function Update() {
    //    var final = new Object();
    //    final.Id = $('#Id').val();
    //    final.Name = $('#Name').val();
    //    final.Weight = $('#Weight').val();
    //    $.ajax({
    //        url: "CourseComprehensions/InsertOrUpdate/",
    //        //data: JSON.stringify(itemObj),
    //        type: "PUT",
    //        //contentType: "application/json;charset=utf-8",
    //        dataType: "json",
    //        data: supplier,
    //        success: function (result) {
    //            console.log(result);
    //            $('#myModal').modal('hide');
    //            //var table = $('#dataGrid').dataTable({
    //            //    ajax: result
    //            //});
    //            loadData();
    //            ClearScreen();
    //            Swal.fire(
    //                'Success',
    //                'Data has been updated',
    //                'success'
    //            );
    //        },
    //        error: function (errormessage) {
    //            Swal.fire({
    //                icon: 'error',
    //                title: 'Oops...',
    //                text: 'Something went wrong!'
    //            })
    //        }

    //    });
    //}

    //function getbyID(Id) {
    //    $.ajax({
    //        url: "/FinalProjects/GetById/",
    //        type: "GET",
    //        data: { id: Id },
    //        dataType: "json",
    //        success: function (result) {
    //            $('#Id').val(result.Id);
    //            $('#Name').val(result.Name);
    //            $('#Weight').val(result.Weight);
    //            $('#myModal').modal('show');
    //            $('#Update').show();
    //            $('#Create').hide();
    //        }
    //    })
    //}

    //function ClearScreen() {
    //    $('#Id').val('');
    //    $('#Name').val('');
    //    $('#Weight').val('');
    //    $('#Update').hide();
    //    $('#Create').show();
    //}

    //function Delete(Id) {
    //    const swalWithBootstrapButtons = Swal.mixin({
    //        customClass: {
    //            confirmButton: 'btn btn-success',
    //            cancelButton: 'btn btn-danger'
    //        },
    //        buttonsStyling: false
    //    });
    //    swalWithBootstrapButtons.fire({
    //        title: 'Are you sure?',
    //        text: "You won't be able to revert this!",
    //        icon: 'warning',
    //        showCancelButton: true,
    //        confirmButtonText: 'Yes, delete it!',
    //        cancelButtonText: 'No, cancel!',
    //        reverseButtons: true
    //    }).then((result) => {
    //        if (result.value) {
    //            $.ajax({
    //                url: "FinalProjects/Delete/",
    //                type: "DELETE",
    //                data: { id: Id },
    //                success: function (result) {
    //                    swalWithBootstrapButtons.fire(
    //                        'Deleted!',
    //                        'Your file has been deleted.',
    //                        'success'
    //                    );
    //                    loadData();
    //                    ClearScreen();
    //                },
    //                error: function (errormessage) {
    //                    Swal.fire({
    //                        icon: 'error',
    //                        title: 'Oops...',
    //                        text: 'Something went wrong!'
    //                    })
    //                }
    //            });


    //        } else if (
    //            /* Read more about handling dismissals below */
    //            result.dismiss === Swal.DismissReason.cancel
    //        ) {
    //            swalWithBootstrapButtons.fire(
    //                'Cancelled',
    //                'Your data is safe :)',
    //                'error'
    //            )
    //        }
    //    })

    //}


</script>